<!DOCTYPE html>
<html>
        <head>
        <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1,user-scalable=no" />
        <meta charset="utf-8">
        <title>Django ORM常用Field详解 | 张雄</title>
        <link rel="stylesheet" href="https://xiong-zh.github.io/styles/main.css">
        <link rel="stylesheet" href="https://at.alicdn.com/t/font_1306644_jwtuc2zzbrd.css">
        <link href="https://cdn.bootcss.com/animate.css/3.7.2/animate.min.css" rel="stylesheet">
         <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
        <script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script>
         <script src="https://cdn.bootcss.com/highlight.js/9.15.10/highlight.min.js"></script>
         <script >hljs.initHighlightingOnLoad();</script>

    </head>
    <body>
              <header class="header mdui-m-b-5">      
            <div class="container  ">
                <div class="index-title animated fadeInDown mdui-text-center mdui-text-color-white mdui-m-b-2" style="animation-delay: 0.2s"><a href="https://xiong-zh.github.io">张雄</a></div>
                <div class="mdui-text-color-white animated fadeInDown mdui-text-center  mdui-m-b-3" style="animation-delay: 0.4s">凡心所向,素履所往。生如逆旅，一苇以航。</div>
           
            <nav id="nav" class="mdui-text-center animated fadeInDown" style="animation-delay: 0.6s">
                   
                            <li><a href="/">回到首页</a>
                                <span class="nav-style top"></span>
                                <span class="nav-style bottom"></span>
                                <span class="nav-style left"></span>
                                <span class="nav-style right"></span>
                                </li>
                    
                            <li><a href="/archives">历史归档</a>
                                <span class="nav-style top"></span>
                                <span class="nav-style bottom"></span>
                                <span class="nav-style left"></span>
                                <span class="nav-style right"></span>
                                </li>
                    
                            <li><a href="/tags">所有标签</a>
                                <span class="nav-style top"></span>
                                <span class="nav-style bottom"></span>
                                <span class="nav-style left"></span>
                                <span class="nav-style right"></span>
                                </li>
                    
                            <li><a href="/documents/">后端图谱</a>
                                <span class="nav-style top"></span>
                                <span class="nav-style bottom"></span>
                                <span class="nav-style left"></span>
                                <span class="nav-style right"></span>
                                </li>
                    
                            <li><a href="/post/about">关于｜友链</a>
                                <span class="nav-style top"></span>
                                <span class="nav-style bottom"></span>
                                <span class="nav-style left"></span>
                                <span class="nav-style right"></span>
                                </li>
                    
                  </nav>
                </div>
        </header>
        <div class="mdui-container ">
                <div class="mdui-row">
                        <div class="mdui-col-md-8 mdui-col-offset-md-2 ">
                                <article class="mdui-p-a-2 post animated fadeIn" style="animation-delay: 0.8s;animation-duration: 2s">
                                    <div class="post-title  mdui-m-b-1">Django ORM常用Field详解</div>
                                    <div class="mdui-typo-body-2 mdui-m-b-2" datetime="2020-01-18 21:04:14">2020-01-18 / 5 min read</div>
                                    <div class="mdui-m-b-2 mdui-typo post-neirong"><p>Django ORM常用Field详解</p>
<!-- more -->
<h2 id="一-常用的field">一、常用的<code>Field</code></h2>
<p><code>book/models.py</code></p>
<pre><code>class Fields(models.Model):

    # 映射到数据库中是int类型，可以有自动增长的特性。一般不需要使用这个类型，如果不指定主键，那么模型会自动的生成一个叫做id的自动增长的主键。
    # auto_id = models.AutoField()

    # 64位的整形，类似于AutoField，只不过是产生的数据的范围是从1-9223372036854775807
    id = models.BigAutoField(primary_key=True)

    # 在模型层面接收的是True / False。在数据库层面是tinyint类型 存储的是 0/1。如果没有指定默认值，默认值是None。
    removed = models.BooleanField()

    # 在数据库层面是varchar类型。在Python层面就是普通的字符串。这个类型在使用的时候必须要指定最大的长度，也即必须要传递max_length
    title = models.CharField(max_length=100)

    # 日期类型。在Python中是datetime.date类型，可以记录年月日。在映射到数据库中也是date类型。使用这个Field可以传递以下几个参数：
    #
    # auto_now：最后一次修改时间，可以将这个属性设置为True。
    # auto_now_add：新增时间，可以将这个属性设置为True。
    birth = models.DateField(auto_now_add=True)

    # 日期时间类型，类似于DateField。不仅仅可以存储日期，还可以存储时间。映射到数据库中是datetime类型。这个Field也可以使用auto_now和auto_now_add两个属性。
    created_time = models.DateTimeField(auto_now_add=True)

    # 时间类型。在数据库中是time类型。在Python中是datetime.time类型。
    lunch_time = models.TimeField()

    # 类似于CharField。在数据库底层也是一个varchar类型。最大长度是254个字符。并不验证邮箱格式，配合 ModelForm 使用时，才会与进行邮箱格式验证
    email = models.EmailField()

    # 用来存储文件的。这个请参考后面的文件上传章节部分。
    # file = models.FileField()

    # 用来存储图片文件的。这个请参考后面的图片上传章节部分。
    # image = models.ImageField()

    # 浮点类型。映射到数据库中是double类型。
    price = models.FloatField()

    # 整形。值的区间是-2147483648——2147483647
    age = models.IntegerField()

    # 大整形。值的区间是-9223372036854775808——9223372036854775807。
    total = models.BigIntegerField()

    # 正整形。值的区间是0——2147483647。
    money = models.PositiveIntegerField()

    # 小整形。值的区间是-32768——32767。
    apple = models.SmallIntegerField()

    # 小整形。值的区间是-32768——32767。
    pear = models.PositiveSmallIntegerField()

    # 小整形。值的区间是-32768——32767。
    content = models.TextField()

    # 只能存储uuid格式的字符串。uuid是一个32位的全球唯一的字符串，一般用来作为主键。
    uuid = models.UUIDField()

    # 类似于CharField，只不过只能用来存储url格式的字符串。并且默认的max_length是200。
    url = models.URLField()
</code></pre>
<h2 id="二-注意事项">二、注意事项：</h2>
<ul>
<li>已经将模型映射到数据库后，修改或新增表字段，如果没有提供默认值，在生成迁移文件时，会提供两个选项，让你添加默认值</li>
</ul>
<pre><code>  (myenv) E:\code\PythonEnvs\myenv\book_manager&gt;python manage.py makemigrations
  You are trying to add a non-nullable field 'age' to fields without a default; we can't do that (the database nee
  ds something to populate existing rows).
  Please select a fix:
  1) Provide a one-off default now (will be set on all existing rows with a null value for this column)
  2) Quit, and let me add a default in models.py
</code></pre>
<ul>
<li>
<p>使用 <code>DateField</code>、 <code>DateTimeField</code> 的自动添加时间参数 <code>auto_now_add</code> 或 <code>auto_now</code>， 添加到数据库使用的是 <code>django.utils.timezone.now()</code> , 这是一个  <code>UTC</code> 时间， 为了在模板中正确显示当前时区的时间，需要配置正确时区</p>
<p><code>book_manager/settings.py</code></p>
</li>
</ul>
<pre><code>  TIME_ZONE = 'Asia/Shanghai'
</code></pre>
<hr>
<p><code>book_manager/urls.py</code></p>
<pre><code>  from django.urls import path, include

  urlpatterns = [
      path('', include('book.urls')),
  ]
</code></pre>
<hr>
<p><code>book/urls.py</code></p>
<pre><code>  from django.urls import path
  from . import views

  app_name = 'book'

  urlpatterns = [
      path('', views.index, name='index')
  ]
</code></pre>
<hr>
<p><code>book/models.py</code></p>
<pre><code>  class Book(models.Model):
      id = models.AutoField(primary_key=True)
      title = models.CharField(max_length=100, null=False)
      author = models.CharField(max_length=100, null=False)
      price = models.FloatField(default=0)
      create_time = models.DateTimeField(auto_now_add=True)
</code></pre>
<hr>
<p><code>book/views.py</code></p>
<pre><code>  from django.shortcuts import render
  from . import models

  def index(request):
      book = models.Book(title='精通ES6', author='zhb333', price=333)
      book.save()
      obj = models.Book.objects.get(pk=1)
      # UTC 时间
      return render(request, 'book/index.html', context={'create_time': obj.create_time})
</code></pre>
<hr>
<p><code>book/templates/book/index.html</code></p>
<pre><code>  {#正确配置时区，即便存储在数据库中的时间是UTC时间，模板中也会正确显示配置的时区所对应的时间#}
  {{ create_time }}
</code></pre>
<h2 id="三-其它不常用的-field">三、其它不常用的 <code>Field</code></h2>
<p><strong>可以在 <code>pycharm</code> 中按<code>ctrl</code> 并点击任一个 <code>Field</code>进入所有<code>Field</code>的定义文件查看</strong></p>
</div>
                                    <div class="mdui-divider mdui-m-b-2"></div>
                                    <div class="mdui-row-xs-2 post-fenye">
                                       
                                        <div class="mdui-col"> <div class="mdui-text-left"><a href="https://xiong-zh.github.io/post/Django模板标签详解">Django 模板标签详解</a></div></div>
                                        

                                        
                                        <div class="mdui-col"><div class="mdui-text-right "><a href="https://xiong-zh.github.io/post/Django创建和映射ORM模型到数据库">Django创建和映射ORM模型到数据库</a></div> </div>
                                       
                                      </div>
                                   
                                    <div class="mdui-divider mdui-m-t-2 mdui-m-b-2"></div>
                                    
          
            <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: '7691fdf5a3780e9bb3a4',
    clientSecret: 'f4bd6c2287489e6b24a18af94afd54efcd0f55f9',
    repo: 'xiong-zh.github.io',
    owner: 'xiong-zh',
    admin: ['xiong-zh'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

          
          
        
                                     <script src="https://xiong-zh.github.io/media/scripts/Valine.min.js"></script>
 <div class="comment"></div>

<script>
      new Valine({
            el: '.comment',



            path: window.location.pathname,
            pageSize: 30,
            avatar:'mm', 
       })
    </script> 
<script>
    if(window.location.hash){
        var checkExist = setInterval(function() {
           if ($(window.location.hash).length) {
              $('html, body').animate({scrollTop: $(window.location.hash).offset().top-90}, 1000);
              clearInterval(checkExist);
           }
        }, 100);
    }
</script>
                                </article>

                                    
                        </div>
                      </div>
    
                

              </div>
                    <footer class="footer mdui-m-t-5 mdui-text-center">
               <nav class="social-links">
                      <ul>
                      
                      
                           
                      	
                        <li class="social-link"><a href="https://twitter.com/imzhangxiong" target="_blank"><i class="iconfont icon-twitter"></i></a></li>
                          
                           
                      	
                        <li class="social-link"><a href="https://github.com/xiong-zh" target="_blank"><i class="iconfont icon-github"></i></a></li>
                          
                           
                      	
                        <li class="social-link"><a href="https://www.zhihu.com/people/yisyxi" target="_blank"><i class="iconfont icon-zhihu"></i></a></li>
                          
                           
                      	
                        <li class="social-link"><a href="https://www.facebook.com/xiong.zh.397" target="_blank"><i class="iconfont icon-facebook"></i></a></li>
                          
                           
                      
                           
                      
                           
                      
                           
                      	
                        <li class="social-link"><a href="https://www.instagram.com/imzhangxiong/" target="_blank"><i class="iconfont icon-instagram"></i></a></li>
                          
                           
                      
                           
                      	
                        <li class="social-link"><a href="https://weibo.com/zhangxiongblog" target="_blank"><i class="iconfont icon-weibo"></i></a></li>
                          
                           
                      
                           
                      </ul>
                    </nav>
                    <div class="copyright">
                      <p>Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> <br/> Theme <a href="https://github.com/alterfang/gridea-theme-song/" target="_blank"  title="宋"  >Song</a> by <a href="https://shanbu.fun/" target="_blank"  title="山卜方" >shanbufun</a> </p>
                  </div>
                  
              </footer>
    </body>
</html>